# 雯婷 - 家庭健康管理系统

一个专为家庭设计的健康管理应用，帮助家庭成员跟踪日常健康任务和用药提醒。现已支持完整的前后端架构，包含用户管理、TODO管理、数据库存储等功能。

## ✨ 功能特性

- 👨‍👩‍👧‍👦 多用户支持，管理整个家庭成员
- 📝 个性化TODO任务管理
- ⏰ 智能提醒系统（具体时间、餐前餐后等）
- 🔄 灵活的重复模式（每天、每周、每月、自定义）
- 🌤️ 天气信息集成
- 📱 移动端响应式设计
- 💾 本地存储 + 云端同步
- 🎨 个性化用户界面

## 🚀 快速开始

### 方法一：使用启动脚本（推荐）

1. **Windows用户**：双击运行 `start.bat`
2. 脚本会自动：
   - 检查环境依赖
   - 安装后端依赖
   - 初始化数据库
   - 启动前后端服务
   - 打开浏览器

### 方法二：手动启动

#### 前置要求

- Node.js (v14+)
- MySQL (v5.7+)
- Python (可选，用于前端服务)

#### 后端设置

```bash
# 进入后端目录
cd backend

# 安装依赖
npm install

# 配置环境变量
cp .env.example .env
# 编辑 .env 文件，配置数据库连接信息

# 初始化数据库
npm run init-db

# 启动开发服务器
npm run dev
```

#### 前端设置

```bash
# 返回根目录
cd ..

# 使用Python启动简单HTTP服务器
python -m http.server 3000

# 或者直接在浏览器中打开 index.html
```

## 📊 访问地址

- 🌐 前端应用: http://localhost:3000
- 🔧 后端API: http://localhost:3001
- 📋 API文档: http://localhost:3001/api
- 💚 健康检查: http://localhost:3001/health

## 🏗️ 项目结构

```
WENTING1.0/
├── 📁 backend/                 # 后端服务
│   ├── 📁 config/             # 数据库配置
│   ├── 📁 models/             # 数据模型
│   ├── 📁 routes/             # API路由
│   ├── 📁 middleware/         # 中间件
│   ├── 📁 scripts/            # 工具脚本
│   ├── 📄 server.js           # 服务器入口
│   └── 📄 package.json        # 依赖配置
├── 📁 js/                     # 前端JavaScript
│   ├── 📄 app.js              # 主应用
│   ├── 📄 apiClient.js        # API客户端
│   ├── 📄 userManager.js      # 用户管理
│   ├── 📄 todoManager.js      # TODO管理
│   └── 📄 ...                 # 其他模块
├── 📁 styles/                 # 样式文件
│   ├── 📄 main.css            # 主样式
│   ├── 📄 components.css      # 组件样式
│   └── 📄 mobile.css          # 移动端样式
├── 📄 index.html              # 主页面
├── 📄 database_schema.sql     # 数据库结构
├── 📄 start.bat               # Windows启动脚本
└── 📄 README.md               # 项目说明
```

## 功能特性

### 🏠 多用户管理
- 支持多个家庭成员（Dad、Mom、Kid）
- 每个用户独立的TODO列表
- 个性化用户标签颜色

### 📋 智能TODO管理
- 添加、编辑、删除TODO项目
- 按时间排序的任务列表
- 支持不同频率任务（每日、隔日、每周）
- 临时和长期任务分类
- 任务完成状态管理

### 📅 日期功能
- 日期导航（前一天/后一天）
- 日历选择器
- 按日期筛选任务
- 自动日期范围计算

### 🔍 智能过滤
- 隐藏已完成任务
- 已完成任务排序到底部
- 过滤状态持久化保存

### 🌤️ 真实天气信息
- **实时天气数据**: 接入Open-Meteo免费API
- **自动定位**: 获取用户当前位置的天气
- **智能更新**: 30分钟自动刷新，支持手动点击刷新
- **完整信息**: 温度、天气状况、风力等级、湿度
- **离线降级**: 网络异常时使用缓存数据
- **加载动画**: 数据更新时的视觉反馈

### 💾 数据持久化
- 本地存储所有用户数据
- 支持数据导出/导入
- 自动保存用户设置

## 技术架构

### 前端技术
- **HTML5**: 语义化标签结构
- **CSS3**: Flexbox布局、Grid布局、动画效果
- **Vanilla JavaScript**: 原生JS模块化开发
- **LocalStorage**: 本地数据持久化

### 设计模式
- **模块化设计**: 每个功能独立成模块
- **事件驱动**: 基于事件的组件通信
- **配置驱动**: 可配置的用户和任务数据
- **响应式设计**: 适配移动端iPhone屏幕

### 代码组织
- **单一职责**: 每个模块负责特定功能
- **松耦合**: 模块间通过事件和配置通信
- **可扩展**: 易于添加新功能和用户

## 使用方法

1. 打开 `index.html` 文件
2. 选择用户标签（Dad/Mom/Kid）
3. 查看和管理对应用户的TODO列表
4. 使用日期导航查看不同日期的任务
5. 使用过滤器管理任务显示

## 开发说明

### 添加新用户
在 `js/config.js` 中的 `APP_CONFIG.users` 数组添加新用户配置。

### 自定义TODO模板
在 `js/config.js` 中的 `APP_CONFIG.defaultTodos` 对象添加用户默认任务。

### 修改样式
- `styles/main.css`: 基础样式修改
- `styles/mobile.css`: 移动端适配
- `styles/components.css`: 组件样式定制

### 扩展功能
每个功能模块都是独立的，可以轻松扩展：
- `dateManager.js`: 日期相关功能
- `todoManager.js`: TODO管理功能
- `filterManager.js`: 过滤器功能
- `userManager.js`: 用户管理功能
- `weatherManager.js`: 天气功能（接入Open-Meteo API）

#### 天气API技术细节
- **API提供商**: Open-Meteo (免费，无需API密钥)
- **数据源**: 15分钟更新的实时气象数据
- **地理定位**: HTML5 Geolocation API
- **数据缓存**: 30分钟本地缓存，减少API调用
- **错误处理**: 网络异常时自动降级到备用数据
- **支持参数**: 温度、湿度、天气代码、风速等

## 浏览器兼容性

- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+

## 未来规划

- [ ] 云端数据同步
- [ ] 更多用户角色支持
- [ ] 任务提醒功能
- [ ] 数据统计分析
- [ ] 主题切换功能
- [ ] 国际化支持

## 更新日志

### v1.1.0 (2025-08-03)
- ✨ **真实天气API集成**: 接入Open-Meteo免费API
- 🌍 **自动地理定位**: 获取用户当前位置天气
- 🔄 **智能刷新机制**: 30分钟自动更新 + 手动点击刷新
- 🎨 **交互优化**: 天气栏点击反馈和加载动画
- 💾 **数据缓存**: 智能缓存策略，减少API调用
- 🛡️ **错误处理**: 网络异常时自动降级到备用数据
- 🧪 **测试工具**: 添加weather-test.html验证API功能

### v1.0.0 (2025-08-03)
- 重构项目架构，模块化代码组织
- 分离HTML、CSS、JavaScript文件
- 优化代码结构和可维护性
- 添加完整的项目文档