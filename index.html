<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>雯婷</title>
    <link rel="icon" href="data:,">
    <link rel="stylesheet" href="build/app.min.css">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/profile.css">
    <style>
        /* 美化的form-row样式 - 使用table布局确保同行 */
        div.form-group div.form-row {
            display: table !important;
            width: 100% !important;
            table-layout: fixed !important;
            border-collapse: separate !important;
            border-spacing: 8px 0 !important;
        }
        
        div.form-group div.form-row input[type="number"],
        div.form-group div.form-row select {
            display: table-cell !important;
            width: 60px !important;
            min-width: 60px !important;
            max-width: 60px !important;
            padding: 8px 6px !important;
            border: 1px solid #e1e8ed !important;
            border-radius: 6px !important;
            font-size: 14px !important;
            text-align: center !important;
            background: white !important;
            box-sizing: border-box !important;
            margin: 0 !important;
            vertical-align: middle !important;
            transition: all 0.2s ease !important;
        }
        
        div.form-group div.form-row input[type="number"]:focus,
        div.form-group div.form-row select:focus {
            outline: none !important;
            border-color: #1d9bf0 !important;
            box-shadow: 0 0 0 2px rgba(29, 155, 240, 0.1) !important;
        }
        
        div.form-group div.form-row select {
            cursor: pointer !important;
            -webkit-appearance: menulist !important;
            appearance: menulist !important;
        }
        
        /* 桌面端样式 */
        @media (min-width: 481px) {
            div.form-group div.form-row {
                border-spacing: 10px 0 !important;
            }
            
            div.form-group div.form-row input[type="number"],
            div.form-group div.form-row select {
                width: 80px !important;
                min-width: 80px !important;
                max-width: 80px !important;
                padding: 8px 12px !important;
                font-size: 14px !important;
            }
        }
        
        /* 强制覆盖任何可能的冲突样式 */
        .form-group input[type="number"]:not(.form-row input),
        .form-group select:not(.form-row select) {
            width: 100% !important;
        }
        
        /* 美化后的form-row样式 */
    </style>
</head>

<body>
    <div class="app-container">
        <!-- 天气栏 -->
        <div class="weather-bar">
            <div class="weather-date-section">
                <div class="weather-date-day" id="currentDate">加载中...</div>
                <div class="weather-date-weekday">...</div>
            </div>
            <div class="weather-location-section">
                <div class="weather-location" id="currentLocation">定位中...</div>
            </div>
            <div class="weather-condition-section">
                <div class="weather-icon">🌤️</div>
                <div class="weather-condition">获取天气中...</div>
            </div>
            <div class="weather-temp">--°C</div>
            <div class="weather-wind">
                <div class="weather-wind-value">--</div>
                <div class="weather-wind-label">风力</div>
            </div>
            <div class="weather-humidity">
                <div class="weather-humidity-value">--%</div>
                <div class="weather-humidity-label">湿度</div>
            </div>
        </div>

        <!-- 加载进度条 -->
        <div class="loading-progress-container" id="loadingProgress" style="display: none;">
            <div class="loading-progress-bar"></div>
        </div>

        <!-- 主内容区 -->
        <div class="main-content">
            <!-- 左侧边栏 -->
            <div class="left-sidebar">
                <!-- 用户标签由userManager.js动态生成 -->
                <div class="add-user-btn" id="addUserBtn" title="添加新用户">
                    +
                </div>
            </div>

            <!-- 右侧内容区 -->
            <div class="content-area" id="contentArea">
                <!-- 动态加载的TODO面板 -->
            </div>
        </div>

        <!-- 底部导航栏 -->
        <div class="bottom-nav">
            <div class="nav-item">
                <div class="nav-icon">
                    <svg viewBox="0 0 24 24">
                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" />
                    </svg>
                </div>
                <div class="nav-label">Todo</div>
            </div>
            <div class="nav-item">
                <div class="nav-icon">
                    <svg viewBox="0 0 24 24">
                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/>
                        <path d="M17 7v2H7V7h10zm-3 4v2H7v-2h7zm0 4v2H7v-2h7z"/>
                    </svg>
                </div>
                <div class="nav-label">Notes</div>
            </div>
            <div class="nav-item">
                <div class="nav-icon">
                    <svg viewBox="0 0 24 24">
                        <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H6.9C4.01 7 1.9 9.11 1.9 12s2.11 5 5 5h4v-1.9H6.9c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9.1-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.89 0 5-2.11 5-5s-2.11-5-5-5z"/>
                    </svg>
                </div>
                <div class="nav-label">Link</div>
            </div>
            <div class="nav-item">
                <div class="nav-icon">
                    <svg viewBox="0 0 24 24">
                        <path
                            d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                    </svg>
                </div>
                <div class="nav-label">Profile</div>
            </div>
        </div>
    </div>

    <script>
        // 检查登录状态
        const currentAppUser = localStorage.getItem('wenting_current_app_user');
        console.log('🔍 检查登录状态:', currentAppUser);
        console.log('🔍 localStorage内容:', Object.keys(localStorage));
        
        if (!currentAppUser) {
            console.log('❌ 未登录，跳转到登录页');
            // 未登录，跳转到登录页
            window.location.href = 'login.html';
        } else {
            console.log('✅ 已登录用户:', currentAppUser);
            // 已登录，继续加载主应用
            document.addEventListener('DOMContentLoaded', function() {
                // 在页面标题中显示当前登录用户
                document.title = `雯婷 - ${currentAppUser}`;
            });
        }
    </script>
    <script src="build/app.min.js" defer></script>
    <script src="js/profileManager.js" defer></script>
</body>

</html>